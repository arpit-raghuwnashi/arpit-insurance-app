<!-- Button to Open the Modal -->
<form>
	<div class="row">
		<div class="col-md-8">
			<button type="button" class="btn btn-md btn-outline-primary" data-toggle="modal" data-target="#Add"
				(click)="reset()">
				Add Underwriter
			</button>
		</div>

		<div class="col-md-4" style="margin-top: 10px;">
			<div class="input-group no-border">
				<div class="input-group-prepend">
					<div class="input-group-text">
						<i class="nc-icon nc-zoom-split"></i>
					</div>
				</div>
				<input class="form-control" type="text" name="searchTerm" (input)="search($event.target.value)"
					placeholder="Search here..." />

			</div>
		</div>
	</div>
</form>

<!-- The Modal -->
<div class="modal fade" id="Add">
	<div class="modal-dialog modal-lg modal-dialog-centered">
		<div class="modal-content">
			<!-- Modal Header -->
			<div class="modal-header">
				<h4 class="modal-title">Add Underwriter</h4>
				<button type="button" class="close" data-dismiss="modal" (click)="reset()">
					&times;
				</button>
			</div>

			<!-- Modal body -->
			<div class="modal-body">
				<form #details="ngForm" (ngSubmit)="registerunderwriter()" novalidate>
					<div class="row">
						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label>First Name</label>
								<input type="text" #fn="ngModel" class="form-control" required pattern="[a-zA-Z ]*"
									name="fname" [class.is-invalid]="fn.invalid && fn.touched"
									[(ngModel)]="register.firstName" placeholder="Enter First Name" />
								<div *ngIf="fn.errors && fn.invalid && fn.touched">
									<small class="text-danger" *ngIf="fn.errors.required">First Name is
										required*</small>
									<small class="text-danger" *ngIf="fn.errors.pattern">First Name should be in a
										correct
										format*</small>
								</div>
							</div>
						</div>

						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label>Last Name</label>
								<input type="text" #ln="ngModel" class="form-control" placeholder="Enter Last Name"
									required pattern="[a-zA-Z ]*" name="lname"
									[class.is-invalid]="ln.invalid && ln.touched" [(ngModel)]="register.lastName" />
								<div *ngIf="ln.errors && ln.invalid && ln.touched">
									<small class="text-danger" *ngIf="ln.errors.required">Last Name is required*</small>
									<small class="text-danger" *ngIf="ln.errors.pattern">Last Name should be in a
										correct
										format*</small>
								</div>
							</div>
						</div>

						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label>Aadhar Number</label>
								<input type="text" #aadhar="ngModel" placeholder="Enter Aadhar Number"
									class="form-control" pattern="^\d{12}$" required name="Aadhar"
									[class.is-invalid]="aadhar.invalid && aadhar.touched"
									[(ngModel)]="register.aadharNo" />
								<div *ngIf="aadhar.errors && aadhar.invalid && aadhar.touched">
									<small class="text-danger" *ngIf="aadhar.errors.required">Aadhar number is
										required*</small>
									<small class="text-danger" *ngIf="aadhar.errors.pattern">Aadhar number
										must be 12
										digits*</small>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-md-3 pr-1">
							<div class="form-group">
								<label>Date of Birth</label>
								<input type="date" name="dob" class="form-control" [(ngModel)]="register.dateOfBirth"
									required #dob="ngModel" />
								<div>
									<small class="text-danger" [class.d-none]="dob.valid || dob.untouched">This field is
										required*</small>
								</div>
							</div>
						</div>

						<div class="col-md-6 pr-1">
							<div class="form-group">
								<label>Email</label>
								<input type="email" #name="ngModel" placeholder="Enter Email" class="form-control"
									pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" required name="email"
									[class.is-invalid]="name.invalid && name.touched" [(ngModel)]="register.email" />

								<div *ngIf="name.errors && name.invalid && name.touched">
									<small class="text-danger" *ngIf="name.errors.required">Email is required*</small>
									<small class="text-danger" *ngIf="name.errors.pattern">Email should be in a correct
										format*</small>
								</div>
							</div>
						</div>

						<div class="col-md-3 pr-1">
							<div class="form-group">
								<label>Password</label>
								<input type="password" #pass="ngModel" class="form-control" placeholder="Enter Password"
									required
									pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
									name="password" [class.is-invalid]="pass.invalid && pass.touched"
									[(ngModel)]="register.password" />
								<div *ngIf="pass.errors && pass.invalid && pass.touched">
									<small class="text-danger" *ngIf="pass.errors.required">Password is
										required*</small>
									<small class="text-danger" *ngIf="pass.errors.pattern">Minimum eight characters, at
										least one
										uppercase
										letter, one lowercase letter, one number and one
										special character must be present*</small>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<!-- <div class="col-md-4 pr-1">
							<div class="form-group">
								<label>Role ID</label>
								<select class="form-control" name="role" [(ngModel)]="register.roleId" required #rid="ngModel">
									<option>2</option>
								</select>
								<div>
									<small class="text-danger" [class.d-none]="rid.valid || rid.untouched">Role ID is
										required*</small>
								</div>
							</div>
						</div>

						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label>Status</label>
								<select name="status" [(ngModel)]="register.status" class="form-control" required #status="ngModel">
									<option>true</option>
								</select>
								<div>
									<small class="text-danger" [class.d-none]="status.valid || status.untouched">Status is
										required*</small>
								</div>
							</div>
						</div> -->

						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label>Gender</label>
								<select #g="ngModel" required name="Gender" [(ngModel)]="register.gender"
									class="form-control" placeholder="Enter Gender">
									<option *ngFor="let gender of genders">
										{{ gender }}
									</option>
								</select>
								<div>
									<small class="text-danger" [class.d-none]="g.valid || g.untouched">Gender is
										required*</small>
								</div>
							</div>
						</div>

						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label>Phone</label>
								<input type="tel" #phone="ngModel" pattern="^\d{10}$" required
									placeholder="Enter Phone Number" class="form-control" name="phone"
									[class.is-invalid]="phone.invalid && phone.touched"
									[(ngModel)]="register.phoneNo" />

								<div *ngIf="phone.errors && phone.invalid && phone.touched">
									<small class="text-danger" *ngIf="phone.errors.required">Phone number is
										required*</small>
									<small class="text-danger" *ngIf="phone.errors.pattern">Phone number must be
										10 digits*</small>
								</div>
							</div>
						</div>

						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label for="qualification">Highest Qualification</label>
								<select class="form-control" name="education" [(ngModel)]="register.education"
									#education="ngModel" required>
									<option>Post Graduation</option>
									<option>Graduation</option>
									<option>Intermediate</option>
									<option>Other</option>
								</select>
								<div>
									<small class="text-danger" [class.d-none]="
                            education.valid || education.untouched
                          ">This field is required*</small>
								</div>
							</div>
						</div>
					</div>

					<div class="row">
						<div class="col-md-4 pr-1">
							<div class="form-group">
								<label>Annual Income</label>
								<input type="tel" #annualIncome="ngModel" required
									placeholder="Enter Annual Income" class="form-control" name="annualIncome"
									[class.is-invalid]="annualIncome.invalid && annualIncome.touched"
									[(ngModel)]="register.annualIncome" />

								<div *ngIf="annualIncome.errors && annualIncome.invalid && annualIncome.touched">
									<small class="text-danger" *ngIf="annualIncome.errors.required">Annual Income is
										required*</small>
								</div>
							</div>
						</div>
					</div>

					<div>
						<button type="button" class="btn btn-secondary btn-round" data-dismiss="modal"
							(click)="reset()">
							Cancel
						</button>

						<button type="submit" class="btn btn-primary btn-round" [disabled]="details.form.invalid">
							Submit
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

<!-- Displaying Underwriters -->
<div class="col-md-13">
	<div class="card shadow-lg">
		<div class="card-header">
			<h4 class="card-title">Active Underwriters</h4>
		</div>
		<div class="card-body">
			<div class="table-responsive table-hover">
				<table class="table">
					<thead class="text-primary text-center">
						<!-- <tr> -->
						<!-- <th>Sr.No.</th> -->
						<th>Underwriter Id</th>
						<th>First Name</th>
						<th>Last Name</th>
						<th>Gender</th>
						<th>Date Of Birth</th>
						<th>Created Date</th>
						<!-- <th>Modified Date</th> -->
						<th>Email Id</th>
						<th>Qualification</th>
						<th>Phone Number</th>
						<th>Aadhar Number</th>
						<th>Action</th>
						<!-- </tr> -->
					</thead>

					<tbody>
						<tr
							*ngFor="let underwriter of underwriters | slice: (page - 1) * pageSize:page * pageSize; index as i">
							<!-- <td style="text-align: center;">{{ (page - 1) * pageSize + i + 1 }}</td> -->

							<td style="text-align: center;">{{ underwriter.userId }}</td>
							<td style="text-align: center;">{{ underwriter.firstName }}</td>
							<td style="text-align: center;">{{ underwriter.lastName }}</td>
							<td style="text-align: center;">{{ underwriter.gender }}</td>
							<td style="text-align: center;">{{ underwriter.dateOfBirth }}</td>
							<td style="text-align: center;">{{ underwriter.createdDate }}</td>
							<!-- <td style="text-align: center;">{{ underwriter.modifiedDate }}</td> -->
							<td style="text-align: center;">{{ underwriter.email }}</td>
							<td style="text-align: center;">{{ underwriter.education }}</td>
							<td style="text-align: center;">{{ underwriter.phoneNo }}</td>
							<td style="text-align: center;">{{ underwriter.aadharNo }}</td>
							<td>
								<!-- Button to Open the Modal -->

								<button type="button" class="btn btn-round btn-outline-danger" data-toggle="modal"
									data-target="#delete" (click)="deleteUnderwriterId(underwriter)">
									Deactivate
								</button>
								<!-- The Modal -->
								<div class="modal" id="delete">
									<div class="modal-dialog">
										<div class="modal-content">
											<!-- Modal Header -->
											<div class="modal-header">
												<h4 class="modal-title">Confirm Delete</h4>
												<button type="button" class="close" data-dismiss="modal">
													&times;
												</button>
											</div>

											<!-- Modal body -->
											<div class="modal-body">
												<p class="text-center">
													Are you sure you want to delete this underwriter?
												</p>
											</div>

											<!-- Modal footer-->
											<div class="modal-footer d-flex justify-content-center">
												<button id="button" type="button" (click)="deleteUnderwriter()"
													class="btn btn-danger" data-dismiss="modal" style="margin: 5px">
													Yes
												</button>

												<button type="button" class="btn btn-dark" data-dismiss="modal"
													style="margin: 5px">
													No
												</button>
											</div>
										</div>
									</div>
								</div>
							</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<ngb-pagination [collectionSize]="collectionSize" [(page)]="page" [maxSize]="5" [boundaryLinks]="true"
	[pageSize]="pageSize" class="d-flex justify-content-center"></ngb-pagination>
